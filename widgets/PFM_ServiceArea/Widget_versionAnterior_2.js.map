{"version":3,"sources":["../../../widgets/PFM_ServiceArea/Widget_versionAnterior_2.js"],"names":["define","declare","BaseWidget","SpatialReference","Layer","FeatureSet","ServiceAreaTask","ServiceAreaParameters","QueryTask","Query","Draw","Point","SimpleFillSymbol","SimpleLineSymbol","SimpleMarkerSymbol","Graphic","Color","on","baseClass","postCreate","inherited","arguments","console","log","onOpen","miMapa","map","i","itemInfo","itemData","operationalLayers","length","capaIterada","visibility","miPunto","miUbicacion","dojo","byId","guardarUbicacion","graphics","clear","herramientaDibujo","activate","POINT","crearPunto","evento","geometry","miSimboloUbicacion","STYLE_SQUARE","STYLE_SOLID","add","deactivate","forEach","seleccionCapas","parametro","capa1","capa2","capa3","capa4","capa5","capa6","capa7","capa8","capa9","capa10","capa11","capa12","capa13","capa14","capa15","errorUbicacion","hayQueSeleccionarUbicacion","generarAreaServicio","capasSeleccionadas","checked","push","value","innerHTML","entidades","ubicaciones","features","tareaAreaDeServicio","parametrosAreaDeServicio","intervalo1","intervalo2","intervalo3","facilities","defaultBreaks","outSpatialReference","spatialReference","returnFacilities","impedanceAttribute","solve","resultado","simboloPoligono","serviceAreaPolygons","areaServicio","setSymbol","poligonoConsulta","setExtent","getExtent","consulta","where","outFields","returnGeometry","miURLConsulta","url","simbolo","layerObject","renderer","symbol","miTareaDeConsulta","execute","geometria","punto","err","message","onClose"],"mappings":"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","file":"Widget_versionAnterior_2.js","sourcesContent":["define([\r\n  'dojo/_base/declare', \r\n  'jimu/BaseWidget',\r\n\r\n  \"esri/SpatialReference\",\r\n  \"esri/layers/layer\",\r\n  \"esri/tasks/FeatureSet\",\r\n  \"esri/tasks/ServiceAreaTask\",\r\n  \"esri/tasks/ServiceAreaParameters\",\r\n  \"esri/tasks/QueryTask\",\r\n  \"esri/tasks/query\",\r\n\r\n  \"esri/toolbars/draw\",\r\n  \"esri/geometry/Point\",\r\n  \"esri/symbols/SimpleFillSymbol\",\r\n  \"esri/symbols/SimpleLineSymbol\",\r\n  \"esri/symbols/SimpleMarkerSymbol\",\r\n  \"esri/graphic\", \r\n  \"esri/Color\",\r\n\r\n  \"dojo/on\"\r\n], function(\r\n  declare, \r\n  BaseWidget,\r\n  \r\n  SpatialReference,\r\n  Layer,\r\n  FeatureSet,\r\n  ServiceAreaTask,\r\n  ServiceAreaParameters,\r\n  QueryTask,\r\n  Query,\r\n\r\n  Draw,\r\n  Point,\r\n  SimpleFillSymbol,\r\n  SimpleLineSymbol,\r\n  SimpleMarkerSymbol,\r\n  Graphic,\r\n  Color,\r\n\r\n  on\r\n  ) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'pfm-service-area',\r\n    // this property is set by the framework when widget is loaded.\r\n    // name: 'PFM_ServiceArea',\r\n    // add additional properties here\r\n\r\n    //methods to communication with app container:\r\n    postCreate: function() {\r\n      this.inherited(arguments);\r\n      console.log('PFM_ServiceArea::postCreate');\r\n    },\r\n\r\n    // startup: function() {\r\n    //   this.inherited(arguments);\r\n    //   console.log('PFM_ServiceArea::startup');\r\n    // },\r\n\r\n    onOpen: function(){\r\n      console.log('PFM_ServiceArea::onOpen');\r\n\r\n      var miMapa = this.map;\r\n      console.log(miMapa);\r\n\r\n      for (var i = 0; i < miMapa.itemInfo.itemData.operationalLayers.length; i++) {\r\n\r\n        if (i <= 1) {\r\n\r\n          console.log(\"La capa \" + i + \" no se oculta.\")\r\n          \r\n        } else {\r\n\r\n          var capaIterada = miMapa.itemInfo.itemData.operationalLayers[i];\r\n          capaIterada [\r\n            visibility = true\r\n          ]\r\n          console.log(\"La capa \" + i + \" se ha ocultado.\")\r\n\r\n        };\r\n\r\n      };\r\n\r\n      // dojo.forEach(miMapa.itemInfo.itemData.operationalLayers, function(capaIterada){\r\n      //   console.log(\"La capa iterada: \", capaIterada);\r\n      //   capaIterada.hide();\r\n      // });\r\n\r\n      var miPunto;\r\n      var miUbicacion;\r\n\r\n      console.log(miPunto);\r\n\r\n      on(dojo.byId(\"ubicacion\"), \"click\", guardarUbicacion);\r\n\r\n      function guardarUbicacion() {\r\n\r\n        miMapa.graphics.clear();\r\n\r\n        var herramientaDibujo = new Draw(miMapa);\r\n        herramientaDibujo.activate(Draw.POINT);\r\n        herramientaDibujo.on(\"draw-end\", crearPunto);\r\n\r\n        function crearPunto(evento){\r\n\r\n          miPunto = new Point(evento.geometry);\r\n\r\n          var miSimboloUbicacion = new SimpleMarkerSymbol(\r\n            SimpleMarkerSymbol.STYLE_SQUARE, \r\n            10,\r\n            new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, new Color([0,0,0]), 1),\r\n            new Color([255,255,255])\r\n          );\r\n\r\n          miUbicacion = new Graphic(miPunto, miSimboloUbicacion);\r\n          miMapa.graphics.add(miUbicacion);\r\n\r\n          herramientaDibujo.deactivate();\r\n\r\n        };\r\n\r\n      };\r\n\r\n      dojo.forEach(this.seleccionCapas, function(parametro){\r\n        console.log(parametro);\r\n      });\r\n      \r\n      var capa1 = this.capa1\r\n      var capa2 = this.capa2\r\n      var capa3 = this.capa3\r\n      var capa4 = this.capa4\r\n      var capa5 = this.capa5\r\n      var capa6 = this.capa6\r\n      var capa7 = this.capa7\r\n      var capa8 = this.capa8\r\n      var capa9 = this.capa9\r\n      var capa10 = this.capa10\r\n      var capa11 = this.capa11\r\n      var capa12 = this.capa12\r\n      var capa13 = this.capa13\r\n      var capa14 = this.capa14\r\n      var capa15 = this.capa15\r\n\r\n      var errorUbicacion = this.hayQueSeleccionarUbicacion;\r\n\r\n      on(dojo.byId(\"ejecutar\"), \"click\", generarAreaServicio);\r\n\r\n      function generarAreaServicio(){\r\n\r\n        var capasSeleccionadas = [];\r\n\r\n        if (capa1.checked == true){capasSeleccionadas.push(capa1.value)};\r\n        if (capa2.checked == true){capasSeleccionadas.push(capa2.value)};\r\n        if (capa3.checked == true){capasSeleccionadas.push(capa3.value)};\r\n        if (capa4.checked == true){capasSeleccionadas.push(capa4.value)};\r\n        if (capa5.checked == true){capasSeleccionadas.push(capa5.value)};\r\n        if (capa6.checked == true){capasSeleccionadas.push(capa6.value)};\r\n        if (capa7.checked == true){capasSeleccionadas.push(capa7.value)};\r\n        if (capa8.checked == true){capasSeleccionadas.push(capa8.value)};\r\n        if (capa9.checked == true){capasSeleccionadas.push(capa9.value)};\r\n        if (capa10.checked == true){capasSeleccionadas.push(capa10.value)};\r\n        if (capa11.checked == true){capasSeleccionadas.push(capa11.value)};\r\n        if (capa12.checked == true){capasSeleccionadas.push(capa12.value)};\r\n        if (capa13.checked == true){capasSeleccionadas.push(capa13.value)};\r\n        if (capa14.checked == true){capasSeleccionadas.push(capa14.value)};\r\n        if (capa15.checked == true){capasSeleccionadas.push(capa15.value)};\r\n  \r\n        console.log(capasSeleccionadas);\r\n\r\n        if (miPunto == null) {\r\n          errorUbicacion.innerHTML = \"Seleccione una ubicación para hacer el área de servicio.\"\r\n        } else {\r\n\r\n          errorUbicacion.innerHTML = \"\"\r\n          \r\n          var entidades = [];\r\n          entidades.push(miUbicacion);\r\n\r\n          var ubicaciones = new FeatureSet();\r\n          ubicaciones.features = entidades\r\n\r\n          tareaAreaDeServicio = new ServiceAreaTask(\"https://localhost:6443/arcgis/rest/services/PFM/20210315_pruebaPublicarServiciosRutas/NAServer/Service%20Area\");\r\n\r\n          parametrosAreaDeServicio = new ServiceAreaParameters();\r\n\r\n          var intervalo1 = dojo.byId(\"intervalo1\").value;\r\n          var intervalo2 = dojo.byId(\"intervalo2\").value;\r\n          var intervalo3 = dojo.byId(\"intervalo3\").value;\r\n\r\n          parametrosAreaDeServicio.facilities = ubicaciones;\r\n          parametrosAreaDeServicio.defaultBreaks = [intervalo1, intervalo2, intervalo3];\r\n          parametrosAreaDeServicio.outSpatialReference = miMapa.spatialReference;\r\n          parametrosAreaDeServicio.returnFacilities = false;\r\n          parametrosAreaDeServicio.impedanceAttribute = \"Length\";\r\n\r\n          tareaAreaDeServicio.solve(parametrosAreaDeServicio, function(resultado){\r\n              \r\n            var simboloPoligono = new SimpleFillSymbol(\r\n              \"solid\",  \r\n              new SimpleLineSymbol(\"solid\", new Color([255,255,255]), 1),\r\n              new Color([255,0,0,0.25])\r\n            );\r\n              \r\n            dojo.forEach(resultado.serviceAreaPolygons,function(areaServicio){\r\n  \r\n              areaServicio.setSymbol(simboloPoligono);\r\n              miMapa.graphics.add(areaServicio);\r\n  \r\n            });\r\n  \r\n            var poligonoConsulta = resultado.serviceAreaPolygons[0].geometry;\r\n            miMapa.setExtent(poligonoConsulta.getExtent(), true);\r\n  \r\n            var consulta = new Query();\r\n            consulta.where = \"1=1\";\r\n            consulta.outFields = [\"*\"];\r\n            consulta.geometry = poligonoConsulta;\r\n            consulta.returnGeometry = true;\r\n            consulta.outSpatialReference = new SpatialReference(102100);\r\n\r\n            dojo.forEach(capasSeleccionadas, function(parametro){\r\n\r\n              var miURLConsulta = miMapa.itemInfo.itemData.operationalLayers[parametro].url;\r\n              var simbolo = miMapa.itemInfo.itemData.operationalLayers[parametro].layerObject.renderer.symbol;\r\n\r\n              var miTareaDeConsulta = new QueryTask(miURLConsulta);\r\n              miTareaDeConsulta.execute(consulta, function(resultado) {\r\n  \r\n                if (resultado.features.length > 0) {\r\n  \r\n                  for (var i = 0; i < resultado.features.length; i++){\r\n  \r\n                    var geometria = resultado.features[i].geometry;\r\n  \r\n                    punto = new Graphic(geometria, simbolo);\r\n  \r\n                    miMapa.graphics.add(punto);\r\n  \r\n                  };\r\n                    \r\n                }; \r\n  \r\n              });\r\n\r\n            });\r\n\r\n\r\n  \r\n            // for (var i = 0; i < capasSeleccionadas.length; i++) {\r\n\r\n            //   var capaIterada = capasSeleccionadas[i];\r\n\r\n            //   console.log(capaIterada);\r\n            \r\n            //   var miURLConsulta = miMapa.itemInfo.itemData.operationalLayers[capaIterada].url;\r\n  \r\n            //   var simbolo = miMapa.itemInfo.itemData.operationalLayers[capaIterada].layerObject.renderer.symbol;\r\n              \r\n            //   var miTareaDeConsulta = new QueryTask(miURLConsulta);\r\n  \r\n            //   miTareaDeConsulta.execute(consulta, function(resultado) {\r\n  \r\n            //     if (resultado.features.length > 0) {\r\n  \r\n            //       for (var i = 0; i < resultado.features.length; i++){\r\n  \r\n            //         var geometria = resultado.features[i].geometry;\r\n  \r\n            //         var simboloGenerico = new SimpleMarkerSymbol(\r\n            //           SimpleMarkerSymbol.STYLE_SQUARE, \r\n            //           10,\r\n            //           new SimpleLineSymbol(SimpleLineSymbol.STYLE_SOLID, new Color([0,0,0]), 1),\r\n            //           new Color([0,0,0])\r\n            //         );\r\n  \r\n            //         punto = new Graphic(geometria, simbolo);\r\n  \r\n            //         miMapa.graphics.add(punto);\r\n  \r\n            //       };\r\n                    \r\n            //     }; \r\n  \r\n            //   });\r\n\r\n            // };\r\n\r\n            miPunto = null;\r\n  \r\n          }, function(err){\r\n            console.log(err.message);\r\n          });\r\n\r\n        }\r\n      \r\n      };\r\n\r\n    },\r\n\r\n    onClose: function(){\r\n      console.log('PFM_ServiceArea::onClose');\r\n\r\n      this.map.graphics.clear();\r\n\r\n    },\r\n\r\n    // onMinimize: function(){\r\n    //   console.log('PFM_ServiceArea::onMinimize');\r\n    // },\r\n\r\n    // onMaximize: function(){\r\n    //   console.log('PFM_ServiceArea::onMaximize');\r\n    // },\r\n\r\n    // onSignIn: function(credential){\r\n    //   console.log('PFM_ServiceArea::onSignIn', credential);\r\n    // },\r\n\r\n    // onSignOut: function(){\r\n    //   console.log('PFM_ServiceArea::onSignOut');\r\n    // }\r\n\r\n    // onPositionChange: function(){\r\n    //   console.log('PFM_ServiceArea::onPositionChange');\r\n    // },\r\n\r\n    // resize: function(){\r\n    //   console.log('PFM_ServiceArea::resize');\r\n    // }\r\n\r\n    //methods to communication between widgets:\r\n\r\n  });\r\n\r\n});\r\n"]}